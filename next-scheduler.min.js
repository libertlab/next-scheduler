/*
 * https://github.com/libertlab/next-scheduler
 * @author: linysuccess@qq.com
 */
function NextOp(i,f){var d=i;var a=f;var c=null;var b=this;var e=[];var h=1;var g=false;this.start=function(){h=e.length+1;d();for(var j=0;j<e.length;j++){e[j].setLeader(this);e[j].start()}};this.finish=function(j){a(j);if(!g&&c!=null){c.start()}b.countdown()};this.setLeader=function(j){b=j};this.setNext=function(j){c=j};this.setParallel=function(j){e=j};this.addParallel=function(j){e.push(j)};this.setBarrier=function(j){g=j};this.countdown=function(){if(g){h--;if(h==0&&c!=null){c.start()}}}}function NextScheduler(){var a=[];this.next=function(e,c){var b=e;if(c!==undefined){if(c instanceof Array){b.setParallel([].concat(c))}else{b.addParallel(c)}}var d=a.length;if(d>0){a[d-1].setNext(b)}a.push(b);return this};this.barrier=function(){var b=a.length;if(b>0){a[b-1].setBarrier(true)}return this};this.start=function(){if(a.length>0){a[0].start()}}};